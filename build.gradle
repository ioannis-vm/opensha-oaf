/*
 * opensha-oaf dependencies
 */

apply from: '../opensha-commons/build-common.gradle'

dependencies {

    /* for the CMU group */
    compileOnly 'org.apache.activemq:activemq-all:5.15.2'
    compileOnly 'com.fasterxml.jackson.core:jackson-annotations:2.8.11'
    compileOnly 'com.fasterxml.jackson.core:jackson-core:2.8.11'
    compileOnly 'com.fasterxml.jackson.core:jackson-databind:2.8.11'
    compileOnly 'org.mongodb:mongo-java-driver:3.6.3'
    compileOnly 'org.mongodb.morphia:morphia:1.3.2'
 
    /* no remote repo */
    compileOnly files('lib/EventWebService.jar')
    compileOnly files('lib/ProductClient.jar')
    compileOnly files('lib/wContour-1.6.1.jar')

    compileOnly project(path: ':opensha-apps', configuration: 'compileOnly')
    compileAndResource project(path: ':opensha-apps')

    testCompile 'junit:junit:4.12'
}

task appOAFJar(type: Jar) {
    baseName = 'AftershockGUI-current-'+getDate()
    from { configurations.compileAndResource.collect {
        it.isDirectory() ? it : zipTree(it).matching {
            exclude { it.path.contains('META-INF') }
        }
    }}
    from { configurations.compileOnly.collect {
        it.isDirectory() ? it : zipTree(it).matching {
            exclude { it.path.contains('META-INF') }
        }
    }}
	manifest {
    	attributes(
			'Class-Path': configurations.compileAndResource.collect { it.getName() }.join(' '),
			'Main-Class': 'scratch.aftershockStatistics.AftershockStatsGUI'
		)
	}
    with jar
}

task appOAF_ETAS_Jar(type: Jar) {
    baseName = 'AftershockGUI_ETAS-current-'+getDate()
    from { configurations.compileAndResource.collect {
        it.isDirectory() ? it : zipTree(it).matching {
            exclude { it.path.contains('META-INF') }
        }
    }}
    from { configurations.compileOnly.collect {
        it.isDirectory() ? it : zipTree(it).matching {
            exclude { it.path.contains('META-INF') }
        }
    }}
	manifest {
    	attributes(
			'Class-Path': configurations.compileAndResource.collect { it.getName() }.join(' '),
			'Main-Class': 'scratch.aftershockStatisticsETAS.AftershockStatsGUI_ETAS'
		)
	}
    with jar
}

task oafJar(type: Jar) {
    baseName = project.name + '-oaf'
    from { configurations.compileAndResource.collect {
        it.isDirectory() ? it : zipTree(it)
    }}
    with jar
}
